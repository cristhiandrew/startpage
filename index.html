<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./main-themes/orange/style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro&amp;display=swap"
      rel="stylesheet"/>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <title>Lawliet</title>
  </head>  

  <body>
    <div>
      <img id="imagenCancion"  alt="Portada de la canciÃ³n">
   <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
       </div>  
    <nav class="navbar">
      <div class="navbar-container container">
        <div><h3 id="currentTime" class="relojito"></h3></div>
        <input type="checkbox" name="" id="" />
        <div class="hamburger-lines">
          <span class="line line1"></span>
          <span class="line line2"></span>
          <span class="line line3"></span>
        </div>
        <ul class="menu-items">
          <li><a onclick="changeCSS('blue',0)">blue</a></li>
          <li><a onclick="changeCSS('cherry',0)">cherry</a></li>
          <li><a onclick="changeCSS('violet',0)">violet</a></li>
          <li><a onclick="changeCSS('green',0)">green</a></li>
          <li><a onclick="changeCSS('orange',0)">wine</a></li>
          <li><a onclick="changeCSS('purple',0)">purple</a></li>
          <li><a onclick="changeCSS('white',0)">white</a></li>
          <li><a onclick="changeCSS('retro-gradient',0)">retro-gradient</a></li>
          <li><a onclick="changeCSS('summer-wave',0)">summer-wave</a></li>
          <li><a onclick="changeCSS('mesh-purple',0)">mesh-purple</a></li>
          <li><a onclick="changeCSS('Animated-Gradient',0)">animated-gradient</a>
          </li>
        </ul>
      </div>      
    </nav>
    <div class="wrapper">
      <div class="bg"></div>
      <div class="maincard">
        <div class="content">
          <div class="image">
            <img id="img"src="./main-themes/orange/images/gif.gif" alt="No image"/>
          </div>
          <div id="links" class="links">
            <section>
              <h3>Daily</h3>
              <ul>
                <li><a href="https://www.youtube.com/" target="_blank">Youtube</a></li>
                <li><a href="https://twitch.tv" target="_blank">Twitch</a></li>
                <li><a href="https://crunchyroll.com/" target="_blank">Crunchyroll</a></li>
                <li><a href="#" onclick="openSpotify()">Spotify</a></li>
              </ul>
            </section>
            <section>
              <h3>Social</h3>
              <ul>
                <li><a href="https://twitter.com/" target="_blank">Twitter</a></li>
                <li><a href="https://Instagram.com" target="_blank">Instagram</a></li>
                <li><a href="https://web.whatsapp.com/" target="_blank">Whatsapp</a></li>
                <li><a href="#" onclick="openDiscord()">Discord</a></li>
              </ul>
            </section>
            <section>
              <h3>Coding</h3>
              <ul>
                <li><a href="https://github.com/cristhiandrew" target="_blank">Github</a></li>
                <li><a href="https://leetcode.com" target="_blank">LeetCode</a></li>
                <li><a href="https://hackerrank.com" target="_blank">HackerRank</a></li>
                <li><a href="https://FreeCodeCamp.org" target="_blank">FreeCode</a></li>
              </ul>
            </section>
            <section>
              <h3>Google</h3>
              <ul>
                <li><a href="https://mail.google.com/mail/u/0/" target="_blank">Gmail</a></li>
                <li><a href="https://drive.google.com" target="_blank">Drive</a></li>
              </ul>
            </section>
          </div>
        </div>
        <div class="search">
          <form onsubmit="return search()">
            <label for="search_box" autofocus>> find / </label>
            <input type="text" placeholder="Type Here" name="search_box" id="search_box" autocomplete="off" autofocus/>
          </form>
        </div>
      </div>
    </div>    
  </body>
  <script>
    let theme = localStorage.getItem("selected-theme");
    var color = theme;
    console.log(color);
    imagenCancion.src="https://galoputo.vercel.app/api?theme="+color;
    if (theme) {
      let selectedTheme = document.createElement("link");
      selectedTheme.setAttribute("rel", "stylesheet");
      selectedTheme.setAttribute("type", "text/css");
      selectedTheme.setAttribute("href", `./main-themes/${theme}/style.css`);
      changeImgSrc(theme);
      // console.log(selectedTheme);
      var oldlink = document.getElementsByTagName("link").item(0);
      document
        .getElementsByTagName("head")
        .item(0)
        .replaceChild(selectedTheme, oldlink);
    }

    function changeCSS(cssFile, cssLinkIndex) {
      console.log("Onclick working");
      var imagenCancion = document.getElementById("imagenCancion");
      var oldlink = document.getElementsByTagName("link").item(cssLinkIndex);
      var newlink = document.createElement("link");
      newlink.setAttribute("rel", "stylesheet");
      newlink.setAttribute("type", "text/css");
      newlink.setAttribute("href", `./main-themes/${cssFile}/style.css`);
      changeImgSrc(cssFile);
      document
        .getElementsByTagName("head")
        .item(cssLinkIndex)
        .replaceChild(newlink, oldlink);
      localStorage.setItem("selected-theme", cssFile);
      imagenCancion.src = "https://galoputo.vercel.app/api?theme=" + cssFile;
      color = cssFile;
    }
    function changeImgSrc(cssFile) {
      var img_bar = document.getElementById("img");
      img_bar.src = `./main-themes/${cssFile}/images/gif.gif`;
    }

    const search_url = "https://duckduckgo.com/";

    function search() {
      const is_url = /^(((http)|(https)):\/\/)?(www\.)?[a-zA-Z0-9]+\.[a-zA-Z]+\/?([a-zA-Z0-9/?=&%-_]+)?$/;
      const is_ip = /^(((http)|(https)):\/\/)?([0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}|localhost)(:[0-9]{1,5})?(\/[a-zA-Z0-9/?=&%-_]+)?$/;
      const search_term = document.getElementById("search_box").value;
      const url_match = search_term.match(is_url);
      const ip_match = search_term.match(is_ip);
      if (url_match != null) {
        window.location.href = url_match[0].substring(0, 4) == "http" ? url_match[0] : "https://" + url_match[0];
      } else if (ip_match != null) {
        window.location.href = ip_match[0].substring(0, 4) == "http" ? ip_match[0] : "http://" + ip_match[0];
      } else {
        window.location.href = search_url + encodeURIComponent(search_term);
      }

      return false;
    }
    function openSpotify() {
            var spotifyURI = 'spotify:';
            window.location.href = spotifyURI;
        }

    function openDiscord() {
            var discordURI = 'discord:'
            window.location.href = discordURI;
    }
    function actualizarImagen() {
          
          var imagen = document.getElementById('imagenCancion');
          imagen.src = "https://galoputo.vercel.app/api?theme="+color+ "&timestamp" + new Date().getTime();
        }
  
        function actualizarImagenPeriodicamente() {
          setInterval(function () {
            actualizarImagen();
          }, 5000);
        }
        actualizarImagenPeriodicamente();

  </script>
  <script type="text/javascript" src="components/clock/clock.js"></script>
</html>